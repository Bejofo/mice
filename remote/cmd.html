<title>uw0tm8</title>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
  <label class="sr-only" for="inlineFormInput">Msg</label>
  <input type="text" class="form-control mb-2 mr-sm-2 mb-sm-0" id="inlineFormInput" placeholder="Hi">
  <button type="button" onclick="send()" class="btn btn-primary btn-lg">Submit</button>
<script src="ably.js"></script>
<script>
     var realtime = new Ably.Realtime("8tpiVA.1ru_8g:k6me0SrZyfPWnBKa"); 
     var channel = realtime.channels.get("rr");
     function send(){
     channel.publish("update", parse(document.getElementById('inlineFormInput').value));
 	   }
 
  
  function parse(str){
	var e = str.split("");
	var i = 0;
	var ai = 0;
	var results = [""];
	while (i <= e.length-1){
		console.log('results')
		if (e[i] == "\\" ){
			results[ai] += (e[i+1])
			i += 2;
			continue;
		}
		if (e[i] == ","){
			ai += 1;
			results[ai]="";
			i++;
			continue
		}
		results[ai] += e[i];
		i++;
	}
	return  {c:results[0], p:results.slice(1)};
}
</script>
